# 8杰弗逊轮塞弗

本章涵盖

*   托马斯·杰斐逊的转轮密码
*   用已知单词解车轮密码
*   在不认识字的情况下解车轮密码

托马斯·杰弗逊在1790年到1793年间的某个时候发明了杰弗逊转轮密码T2，当时他是乔治·华盛顿的国务卿。该装置由一根直径1/8至1/4英寸、长6至8英寸的铁棒或心轴组成，带有36个直径约2英寸、厚1/6英寸的木制圆盘。每个圆盘的中心都钻有一个与杆一样大小的孔，这样所有的圆盘都可以紧贴在杆上，形成一个木制的圆柱体。圆盘的平面相互接触，外部圆形边缘可见。杆的一端有一个头，像一个钉子头。另一端有螺纹，这样螺母就可以拧到杆上，牢牢地固定住圆盘。

圆盘平面上的数字是从1到36。圆形外边缘被分成26个相等的部分。字母表的26个字母以某种混乱的顺序被写入或切割成这26个部分，这对于每个盘来说是不同的。磁盘在主轴上的顺序是密码的关键，现在称为*多路密码* 。

马里兰州米德堡的国家密码博物馆展示了一个26盘杰弗逊赛弗轮盘的复制品。(图片由Daderot根据Creative Commons CC0 1.0许可提供。)

![8-unnumb-1](Images/8-unnumb-1.png)

首先将磁盘按密钥指定的顺序放在主轴上，用该设备对信息进行加密。螺母拧得很松，这样就可以转动各个圆盘。在第一个圆盘上找到信息的第一个字母，然后转动第二个圆盘，使信息的第二个字母紧挨着第一个字母。然后转动第三个圆盘，使信息的第三个字母紧挨着第二个字母，依此类推，直到信息的前36个字母排成偶数行。然后拧紧螺母，将它们固定到位。

转动圆柱体，还有另外25排字母，都是无意义的乱码。桑德拉可以选择其中任何一个作为密文。丽娃重复这个过程，在圆柱体的一行上建立密文。其他25行中的哪一行是想要的消息是显而易见的。

杰斐逊显然从未将这种密码投入使用。这个概念一直处于休眠状态，直到19世纪90年代初被tienne Bazeries重新发明。它于1901年被法国人采用。Bazeries的版本有两处改进。它有一个支架或支架，因此该设备可以放在桌子上进行双手操作，它有一个指南，可以帮助用户均匀地排列字母，并选择读取密文的行。这种使用25个铝盘的密码版本由帕克·希特上校于1914年发明，1922年被美国陆军采用为M-94 ，1926年被美国海军采用为CSP-488 。Hitt的版本只有4.25英寸长，小到足以放在口袋里，并且在磁盘的平面上有凹槽和尖头，防止它们在对齐后滑动。

这是一张来自国家密码博物馆的CSP-488的照片。

![8-unnumb-2](Images/8-unnumb-2.png)

Hitt于1916年发明了一种平面型密码，并于1935年被军队采用为M-138。这个版本是一个有25个通道的扁平铝板，上面有纸条，可以前后滑动来模拟磁盘的转动。每张纸条都有两份混乱的字母表。这种装置更安全，因为纸条可以很容易地更换，如果需要，甚至可以在现场手写。这很快被海军的M138A或CSP-845取代，它有30个纸条的插槽。该设备提供了100条试纸，由两位数字指定，因此任何信息都会使用100条试纸中的30条。这允许100个！/70!= 7.79×10 <sup class="fm-superscript">57</sup> 可能的按键。

M-138A的中间有一个铰链，可以折叠起来，便于携带。每一半都有一个单独的导向装置，用来排列纸条，读出密码的15个字母。这些改进大大加强了密码。

这些条形密码在1942年或1943年左右被陆军丢弃，但它们仍然被海军用作备用，以防断电导致无法使用任何电子或机电密码装置。

如果艾米丽没有该装置的副本并且不知道字母表，则破解多重密码T2是不可行的。如果艾米丽拥有这个装置，如果她知道一些可能的单词，这个密码相对容易破解。当Emily拥有该设备的副本并知道一些可能的单词时，Jefferson Cypher Wheel被评为4到5级。当没有已知的可能单词时，等级是6到7。艾米莉的密文越多，等级越低。相反，如果设备有很多额外的磁盘，则评级会上升。例如，如果用户从100个盘的供应中选择30个盘，则评级可以达到8。对于非常短的消息，少于两倍的磁盘数量，解决方案可能是不可能的，除非Emily使用相同的密钥拦截多个消息。如果发送方每天只更改一次磁盘顺序，就可能会发生这种情况。

## 8.1已知单词解决方案

当你有足够的文本，并且你知道至少一部分信息时，你可以解开一条用杰弗逊密码轮加密的信息。通常，只要一个已知单词就足够了。假设你知道桑德拉正在使用有25个磁盘的M-94 设备，你截获了一条消息:

![8-unnumb-3](Images/8-unnumb-3.png)

假设你也知道明文信息开始是紧急的。这已经转化为密文 **CLPOXF** 。由于URGENT在一行而 **CLPOXF** 在另一行，相应字母对之间的距离必须相同。我们先把急行1的行叫做急行，假设急行 **CLPOXF** 的行是急行8。明文的第一个字母U和密文的第一个字母C取自第一个磁盘的第1行和第8行。所以，在第一个圆盘上，从U到C的距离一定是7。在第二个圆盘上，从R到L的距离一定是7。在第三个圆盘上，G到P的距离一定是7，E到O，N到X，T到f的距离也是7。

最简单的搜索方法是从1到25依次尝试每个可能的距离。从距离1开始。找出从U到C的距离为1的所有圆盘。换句话说，U后面的下一个字母是c，如果没有这样的圆盘，那么你知道距离不是1。然后找出从R到L的距离为1的所有圆盘。同样，如果没有，距离不能是1。

让我们假设你已经找到了12组字母对的距离都是1的圆盘。您现在需要测试这12组数据，看看是否有正确的。假设第一组圆盘是18-4-21-9-13-11。从密文的第二块开始测试，字母26到50。这个街区从T2T4【ESI wvi】开始。将磁盘18设置为字母 **E** ，磁盘4设置为字母 **S** ，磁盘21设置为字母 **I** ，以此类推。现在看看其他25行。如果都是胡言乱语，像 **HNSAEI** 或者 **TFPGUW** ，那么你就知道18-4-21-9-13-11不是正确的盘面顺序。另一方面，如果您看到一些看似合理的文本，如NCONDI，它可能是单词UNCONDITIONAL的一部分，那么18-4-21-9-13-11可能是正确的磁盘顺序。再次使用从 **GAFOEM** 开始的密文的第三个块进行测试。如果第三和第四个块都导致合理的文本段，那么18-4-21-9-13-11可能是正确的...但是继续搜索，因为您可能会找到更好的磁盘序列。

如果你看不到任何可能的文本片段，那么试试其他11个磁盘序列。如果这些都不起作用，尝试距离2，然后距离3，...通过距离25。可能会有数百种磁盘顺序和距离的组合需要测试。这很繁琐，但手工操作仍然可行。如果没有效果，返回去寻找3次测试中有2次给出可信文本的磁盘序列。

一旦你确定了前6个圆盘最可能的顺序，以及相应的距离，然后你试着把它扩展到第7个圆盘。对于每一个选择的磁盘，你已经知道从明文到密文的距离，所以扩展过程相当快。

## *8.2纯密文解决方案

在没有已知单词的情况下，也可以解开多重密码。这被称为纯密文解决方案。我是第一个找到这种解决方案的人(“解密多重密码的计算机方法”) *Cryptologia* 2期(1978年4月)，第152-160页)。在1978年的原始论文中，我使用了二元模型频率，并逐步发展为三元模型。今天的计算机速度更快，存储容量更大，所以我们可以跳过bigram这一步。该方法假设您有一个表格，用英语给出了每个可能三元模型的概率。你可以自己编一个这样的表，或者从网上下载一个三元模型表。这是这个方法的要点。

让我们像以前一样假设Emily正在使用具有25个密码字母的M-94 设备，并且我们已经截获了至少3个块或75个字母的消息。我们所知道的信息是用英语写的。例如，假设我们截获了

![8-unnumb-4](Images/8-unnumb-4.png)

从尝试前3个磁盘的所有可能选项开始。这样的选择有25×24×23 = 13800个。对于每个选项，将磁盘设置为密文每个块的前3个字母，即 **CLP** 、 **ESI** 和 **GAF** 。对于这些三元模型中的每一个，查看其他25行。这些行包含对应于密文三元组的可能的明文三元组。由于3行中的每一行有25个选择，所以可能性的总数是13800×25 <sup class="fm-superscript">3</sup> = 215，625，000。这可以由台式计算机，甚至笔记本电脑轻松处理。

对于3个磁盘和3行的每个组合，该组合的概率是3个明文三元模型的概率的乘积。等价地，概率的对数是3个三元组概率的对数之和。这个想法是只保留最有可能的组合，丢弃其余的。例如，您可以只保留前1%，或者您可以保留固定数量的好组合，也许是100万个最佳组合。假设你选择保留前200万。

一种方法是生成所有的215，625，000个组合，然后根据概率对它们进行排序，并扔掉最差的99%。那会占用很多存储空间。有更好的方法来做到这一点。首先分配一个比您想要的组合数大10%到25%的表，比如说2500000个组合。开始生成组合并将它们放入表中。当表变满时，它需要被削减大约20% 。

这可以通过对表格进行排序并删除底部的20%来完成。也就是说，您按照递减概率排序，然后将表条目的数量设置为2，000，000。对2，500，000项进行排序比对215，625，000项进行排序要快得多，但还有更快的方法。从表中随机选择10个项目。(如果你不知道如何随机选择，那么选择1/11，2/11，...，10/11的路程。)从可能性最小到可能性最大对这10项进行排序。称这些排序后的项为a，b，c，d，e，f，g，h，I，j设P为项b的概率，删除表中概率小于P的每一项。

继续生成组合，但不要向表中添加任何概率为P或更小的项目。每次表填满时，重复采样、对样本进行排序和重置截止概率p的过程。

最后，你将会有大约2，000，000个3个圆盘和3行的组合。下一步是将其扩展到4个磁盘。为第四张磁盘尝试所有22种可能的选择。这将给你大约44，000，000个组合。现在看看由圆盘2、3和4形成的三元模型。对于每个组合，将盘1、2、3上三元模型的概率乘以盘2、3、4上三元模型的概率，以获得所有4个盘上四元模型的近似概率。将三个密文四边形****ESIW****【GAFO】**对应的明文四边形的概率相乘。**

 **这将给出4个圆盘和3行的44，000，000种组合的概率。还是那句话，你可以保留最好的1%给你44万套四方图。使用与三元模型相同的方法。

继续这样做，得到五角星形、六边形、七边形等等。每次添加磁盘时，您可以保留的组合数量会比前一次少。当你降到100以下时，你可以通过视觉挑出正确的组合，然后手工完成解决方案。

可能导致此过程失败的一个问题是:即使在普通文本中，三元模型也可能出现在您的三元模型表中，其概率为0。如果Emily使用空值，这可能会经常发生。这可能会导致合法的明文被拒绝。

一个解决方案是改变三元模型的概率，这样0概率永远不会发生。让我们用P(x)来表示一个字符串X的概率。如果一个三元组，比如说XYZ的概率是零，你可以用P(X)P(YZ)和P(XY)P(Z)中的较大者。我建议将这个除以3，比如说，因为XYZ从未出现在你的三元组计数中。如果XYZ的概率仍然是0，那么使用单个字母。比如设置P(XYZ)为P(X)P(Y)P(Z)/10 。

另一个不同的解决方案不是将概率相乘，而是使用一些其他函数来组合它们。例如，您可以将概率的平方和相加。这将强烈奖励常见的三元模型，而在很大程度上忽略罕见的三元模型。

如果所有这些都失败了，那么只需从密文中的不同起点再次尝试该过程。例如，从第五个盘开始。 ********