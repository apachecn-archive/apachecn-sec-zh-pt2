# 9分馏

本章涵盖

*   波利比乌斯广场
*   将一个字母拆分成更小的部分，如位或十六进制数字
*   混合和重组那些部分

密码学的前两个基本工具是替换和换位，这将在第5章到第8章中讨论。密码学的第三个基本要素是分段。这意味着将语言、字母、音节和单词的正常单位分解成更小的单位，并在这些单位上进行操作。较小的单位通常是位、十进制数字、十六进制数字或其他基数的数字。这一章包括使用基数为2、3、5、6和16的数字的小数部分，以及一些其他形式的小数部分。

## 9.1波利比乌斯广场

可能是 将字母表示为更小单位的最古老的方法是*波利比乌斯方块*，我们在第4.4节看到过。在这里，每个字母由两个以5为基数的数字表示，有25种可能的2位数组合。(希腊人没有0的表示法，所以他们的数字从1开始。)

这是第4.4节中的波利比乌斯广场。每个字母用它在正方形中的*坐标*T3表示，也就是用它的行号和列号表示。例如，字母P位于第2行第5列，因此表示为25。为了清楚起见，这也可以写成2，5。

![9-unnumb-1](img/9-unnumb-1.png)

一个波利比乌斯方块本身可以产生许多不同的密码。例如，它可以通过将消息中的每个字母替换为方块右侧的字母(U变为 **V** )、下方的字母(U变为 **Z** )、下方和右侧的字母(U变为 **S** )或左侧的字母(U变为 **P** )等等，来产生简单的替换。通过改变方向，例如右、左、下、右、左、下等，这种思想可以扩展到多字母密码。你也可以走两个字母远，或者像在国际象棋中一样使用骑士步。

一个波利比乌斯方块也可以用来产生一个*波利比乌斯波纹*密码 。从用坐标代替信息的每个字母开始，简单地写在一行中。从列表中的第二个数字开始，将前一个数字加到当前数字上。如果总和大于5，则减去5，使数字保持在1到5的范围内。然后再用波利比乌斯方块把这些数字变回字母。

![9-unnumb-2](img/9-unnumb-2.png)

波利比乌斯波纹密码被评为三级。可以通过使用不同的波利比乌斯方块将坐标转换回字母来增强密码。

让我们在第9.2节到第9.7节中看看19世纪基于波利比乌斯广场的几个手密码。我在9.8到9.11节中介绍了一些额外的手工方法。然后我在 一章的剩余部分讨论一些计算机方法。

## 9.2游乐场

*游乐场*密码是查尔斯·惠斯通(读作WHIT-stun)在1854年发明的。惠斯通是电气工程师中众所周知的惠斯通电桥的发明者，该电桥用于测量电阻。惠斯通和威廉·库克发明了针式电报机比塞缪尔·莫尔斯发明按键电报机早几年。在莫尔斯在美国开办电报公司的几年前，库克就在英国将针式电报商业化了。

惠斯通的密码被称为公平密码,因为是惠斯通的长相酷似的朋友莱昂·普莱费尔男爵(两人都有鲜红色的头发，身高约5英尺2英寸)倡导使用这种密码，并说服英国外交部使用这种密码进行外交通信。

抛开历史不谈

因为这种密码不叫惠斯通密码，所以惠斯通的名字可用于第二种密码，惠斯通大约在1860年发明，并在1867年的巴黎世界博览会上展出。惠斯通密码器T3，看起来像一个大怀表，由两个由硬纸板制成的固定同心环和两个由简单发条装置连接的可移动时钟指针组成。内环是可擦除的，可以根据每条消息进行更改。这一环有26个字母的排列顺序，而外环有标准的26个字母的字母加上一个空格，有27个位置。你移动时钟长指针指示外环上的明文字母，短指针移动指示内环上的密文字母。当长时钟指针完成27个位置的一次旋转时，短指针也移动27个位置，这是1次完整的旋转加上1个额外的字母位置。所以短指针从每圈的不同点开始。1817年，军械长德西乌斯沃兹沃斯上校根据托马斯·杰斐逊1790年制定的计划制造出了一种带有可移动环且没有指针的等效装置，但惠斯通的名字永远与这一概念联系在一起。

照片由拉尔夫·辛普森提供。碑文写着

“密码本。惠斯通Inv <sup class="fm-superscript1">r</sup>

![9-unnumb-3](img/9-unnumb-3.png)

play fair密码以波利比乌斯方为基础，一次加密两个字母。也就是说，它加密二元模型。正方形可以通过使用第5.2节中的任何方法混合字母表来制备。省略了字母表中的一个低频字母，例如J、Q或Z，以使字母表适合5×5的正方形。(在法语中，J、Q和Z是常见的，所以省略w。在德语中，省略Q、X或y。)当被省略的字母出现在消息中时，会选择一些其他字母来替换它。在我们的例子中，每个J由一个 **I** 代替。

下一步是将信息分成二元模型，例如ME ET ME TO MO RR OW。如果一个二元模型是一个双字母，那么它应该被分开，通常是在中间插入一个X。(这是一个不把X从方块中省略的很好的理由。)此外，如果消息包含奇数个字母，则会在末尾添加一个X。这条信息变成了“让我去WX”。现在我们准备加密它。

Playfair 有3个规则:(1)如果两个字母在同一行，每个字母都被它右边的字母代替；(2)如果字母在同一列中，则每个字母由它下面的字母代替；(3)对于所有其他字母，每个字母都由同一行中的字母替换，但在二元组的另一个字母的列中。据了解，正方形是环绕的，所以在9.1节的正方形中，Y右边的字母是U，Q下面的字母是w。

这些规则可以用坐标来重述。假设我们要加密的二元模型是r1c1 r2c2，这样第一个字母在c1列的r1行，第二个字母在c2列的r2行。现在这三条规则变成了

1.  如果r1 = r2，则替换r1，c1+1 r2，c2+1。

2.  如果c1 = c2，则替换r1+1，c1 r2+1，c2。

3.  否则代入r1，c2 r2，c1。

让我们对发送到WX的示例消息ME ME ME进行加密，看看这些规则是如何工作的。第一个二元模型是我。m和E在不同的行和不同的列，所以规则3适用。m在第2行第4列，E在第3行第2列。所以M被同一行的字母代替，即第2行，与字母E在同一列，即第2列。第2行第2列的字母是S，所以M被替换为 **S** 。同样，E被第3行第4列的字母代替，即 **C** 。

同理ET换成 **DO** ，第二me换成 **SC** 。字母T和O在同一行，所以规则1适用。它们被右边的字母所取代。t被替换为**N**O被替换为 **Q** 。所以到是用 **代替了** 。

莫遵循规则3。取而代之的是T2SR。r和X在同一列，所以规则2适用。RX换成 **XM** 。RO和WX都使用规则1，被替换为 **TQ** 和 **XY** 。整个消息就这样变成了**SC DO SC NQ SR XM TQ XY**，也就是重组后的**SCDOS CNQSR xmt qx Y**。

这里有一些图表可以帮助你想象二元模型LY、to和RX是如何被加密的。

![9-unnumb-4](img/9-unnumb-4.png)

至少在1960年之前，公平竞赛密码一直在军事和外交上使用。接下来，让我们简单看看一个公平游戏密码是如何被破解的。

### 9.2.1求解一个公平密码

注意 每个字母只能由5个可能的替代字母加密，即该行的其他4个字母和紧接在它下面的字母。对于每个字母，网格中还有24个其他字母。其中，只有其自身列中的4个字母会导致该字母被其下方的字母替换。所以一个字母被下面这个字母代替的几率是4/24，或者1/6。因此，它被该行中的另一个字母替换的可能性是5/6。

由于正方形中有5行和9个出现频率超过5%的英文字母，因此一定有几行包含至少2个高频字母。如果这样的行少于4行，那么必须至少有一行有3个高频字母。这些行中的其他字母将比任何其他字母更频繁地出现在密文中。如果你有足够的密文，那么密文中3到5个最频繁出现的字母很有可能出现在正方形的同一行中。

如果我们移除包含这些字母的所有二元模型，剩余二元模型中最频繁出现的3到5个字母很可能在正方形的同一行上。知道5排中2排上的高频字母，就足以开始方块的重建了。下一步是尝试放置一些可能的单词。

公平竞赛密码被定为三级。有几种方法可以增强Playfair密码的强度。让我只提一个 几个。

### 9.2.2强化公平密码

这里的 是公平竞赛密码的几种更强的变体。

NullfairT2或者no fairT4】

空值可以以重复的间隔添加到密文中，如下所示:

![9-unnumb-5](img/9-unnumb-5.png)

Nullfair被评为五级。

游乐场+1

这种超级简单的增强将重复的二进制密钥添加到Playfair密文中。只要有1位，就使用字母表的下一个字母。如果二进制密钥的长度为奇数，则Playfair+1 更强。

![9-unnumb-6](img/9-unnumb-6.png)

Playfair+1 被评为五级。Playfair+1也可以用三进制数来完成。加法键中的数字很小，所以加法可以在头脑中完成，而不需要表格。

双重公平竞争

play fair密码应用两次可以加强。在第二轮中，两人应该跨在第一轮中创建的二元模型上。(1)用公平密码对信息进行加密。(2)要么把第一个字母移到末尾，要么把最后一个字母移到开头，要么在两端加一个null。(3)应用另一轮公平竞争。如果不同的混合字母表用于第二公平密码，这是最强的。双公平被定为6级。

游乐场的涟漪

这是double Playfair的一个变种，它只需要传递一次信息，并且只需要一个波利比乌斯广场。设明文为P<sub class="fm-subscript">1</sub>P<sub class="fm-subscript">2</sub>P<sub class="fm-subscript">3</sub>P<sub class="fm-subscript">4</sub>...从左端开始，使用Playfair加密明文二元模型P <sub class="fm-subscript">1</sub> P <sub class="fm-subscript">2</sub> ，产生密文二元模型C <sub class="fm-subscript">1</sub> C <sub class="fm-subscript">2</sub> 。然后加密C <sub class="fm-subscript">2</sub> P <sub class="fm-subscript">3</sub> 为第二二元组，得到D <sub class="fm-subscript">2</sub> C <sub class="fm-subscript">3</sub> 。注意D <sub class="fm-subscript">2</sub> 已经加密了两次。接下来你加密C <sub class="fm-subscript">3</sub> P <sub class="fm-subscript">4</sub> ，得到D <sub class="fm-subscript">3</sub> C <sub class="fm-subscript">4</sub> 等等，每一步向右移动一个字符。Playfair ripple 被评为六级。

由于密文的第一个字母C <sub class="fm-subscript">1</sub> 和最后一个字母C <sub class="fm-subscript">n</sub> 只加密过一次，你不妨把它们加密成一个二元模型来完成这个循环。

![9-unnumb-7](img/9-unnumb-7.png)

息肉会

使用两个不同的波利比乌斯方块，并使用重复键在它们之间交替。例如，11212的密钥意味着在5个二元模型的每个周期中，第一、第二和第四个二元模型用平方1加密，而第三和第五个二元模型用平方2加密。这可以扩展到三个或更多方块，相应地需要更长的设置时间。使用两个方块和一个不超过10个数字的钥匙的多玩家被评为五级。如果密钥是由链式数字算法生成的，当数字为0到4时使用第一个方块，当数字为5到9时使用第二个方块，则等级增加到6。(注:使用链式数字序列的奇偶性，周期短得多，所以弱得多。)

换位

明文用Playfair 密码加密后，得到的密文可以被转置。转置可以像7.2节的列转置一样精细，也可以像4.6.1节的Bazeries型密码 的分段反转一样简单。有了柱状换位，游乐场被 评为七级。随着分段逆转，公平竞赛被分为五个等级 。

## 9.3两个正方形

*两方*密码 ，有时也称为*双公平* ，是公平密码的改进版本。它是由法国业余密码学家Félix-Marie Delastelle 发明的，并在他1902年的著作*traitélémentaire de cryptogie*中有所描述。顾名思义，它使用两个波利比乌斯方块而不是一个，这样就有两个混合字母而不是一个。这两个方块可以水平并排放置，也可以垂直自下而上放置。图示为横版。在本例中，使用关键字 FIRST和SECOND混合了两个正方形，并省略了字母Q以适应5×5网格。

![9-unnumb-8](img/9-unnumb-8.png)

像游乐场 一样，信息一次加密两个字母。也就是两方加密二元模型。对二元模型进行加密，这样我们可以在左边的方块中找到S，在右边的方块中找到O。代替S的是与S同行、同列的右边方框中的字母，即T5】TT7】。代替O的是与O同行同列的左方格中的字母，即 **K** 。这样二元组就变成了 **TK** 。

不像游乐场，没有必要拆散双字母。这两个字母可以在两个方块的不同行上。比如SS变成了 **MK** 。在大多数情况下，密文中的双字母不会对应于明文中的双字母。

下面是直观的替换过程。

![9-unnumb-9](img/9-unnumb-9.png)

两个正方形密码的一个重要弱点是，当一个二元模型的两个字母落在网格的同一行时，替代物只是那些颠倒的字母。比如，ST会变成 **TS** 。这一弱点被称为*透明* ，有时会让整个单词泄露出去。例如，周日将变成 **US DN YA** 。

为了防止这种情况，我提出了这个*同行规则*:当两个字母在同一行时，它们被紧接在它们下面的字母替换，必要时绕到最上面一行。比如ST现在会变成 **DY** ，VI会变成 **FP** 。

同排法则，两个正方形被评为四。把这种变异叫做*二方块B*T5】。

德国人从字面上理解“双公平竞赛”这个名字。他们用两个正方形 密码加密每个二元模型，然后再用两个正方形加密那个二元模型。结果基本上是一个一般的二元模型替换(6.5节)。

用于增强公平游戏密码的相同方法也可以用于增强两方密码，例如具有相同等级的*两方+1* 和*两方波纹* 。这里有一个额外的变体。

Playfair TwoSquare

两个正方形密码使用两个波利比乌斯正方形。这些方块中的任何一个都可以用作公平竞赛密码。这暗示了一种混合的方法，混合了公平竞赛和两方。同样，我们将使用一个数字键来控制每个连续的二元模型是如何加密的。1表示使用左边方块中的Playfair加密二元模型，2表示使用右边方块中的Playfair加密二元模型，3表示使用两个方块或两个方块B 加密二元模型。如果数字键包含每个数字中的至少一个，这是最好的。因为二方块比公平游戏更强大，所以3应该比1或2更经常出现。大约50%是合适的。 *Playfair TwoSquare* 被评为 六。

## 9.4三个 广场

*三方形* 是我自己的想法。否则，它没有什么特别的优点。我把它放在这里只是因为我在为这本书做研究时读过的一本书说，两个正方形不能扩展到两个以上的正方形。我喜欢挑战。

顾名思义，三个正方形采用三个波利比乌斯正方形。这些方块应该用独立的键很好地混合。三格一次加密3个字母，即加密八卦。这使得它比两个正方形更强。

![9-unnumb-10](img/9-unnumb-10.png)

基本的想法是每个字母都被它右边的方块中的一个字母代替。替换字母在同一行，但是在包含三元模型的下一个字母的列中。

假设我们希望加密三元模型。第一个字母是T，第二个字母是H，第三个字母是E。我们使用第一个方块中的T，第二个方块中的H和第三个方块中的E进行加密，就像这样。

![9-unnumb-11](img/9-unnumb-11.png)

T的替代在包含T的那一行，在包含H的第二个方块的那一列，所以T被替换为 **V** 。H的替代与第三个方块中的E在同一列的H在同一行，所以H被替换为 **R** 。E的替代与包含T的第一个正方形的列中的E在同一行，因此E被替换为 **Z** 。这样一来，VRZ的 **就变成了** 。

这可以形象地看如下:

![9-unnumb-12](img/9-unnumb-12.png)

解读的方向相反。由于密文三元组**的第一个字母来自第二个方块，我们从第二个方块开始解密，如下所示:**

 **![9-unnumb-13](img/9-unnumb-13.png)

三个方块 比字母落在同一行的两个方块 问题更严重。在诸如XYZ的三元模型中，X和Y可能落在同一行，Y和Z可能落在同一行，或者Z和X可能落在同一行。这需要两条额外的规则来防止字母代表自身的透明。

*规则1:* 如果三元组中的两个连续字母落在同一行，这两个字母中的第一个被加密为第二个字母右侧的字母，如果需要，则绕到左列。例如，在三元组子图中，S在第一个方块的顶行，U在第二个方块的顶行。因此S由 **V** 代替 **U** 。类似地，在三元组LET中，T在第三个正方形的第三行，L在第一个正方形的第三行。所以T换成了 **G** 而不是 **L** 。

这张图展示了规则1。如果没有规则1，三元组SUB中的S将被替换为**。取而代之的是中间方块中U右边的字母，即 **V** 。如果没有规则1，三元模型中的T将由 **L** 代替。取而代之的是左边方块中L右边的字母。这从第5列绕到第1列，第1列有字母 **G** 。**

 **![9-unnumb-14](img/9-unnumb-14.png)

*规则2:* 如果三元模型中的三个字母都落在同一行，每个字母将被其下一个字母替换，如果需要的话，可以换行到最上面一行。于是，乐趣将被**取代，WRE将被**取代。****

 ****用这些规则三个正方形 被评为五格。

【play fair threw】

三方块密码使用三个波利比乌斯方块。这些方块中的任何一个都可以用作公平竞赛密码。这暗示了一种混合的方法，混合了公平游戏和三个正方形密码。您可以使用一个数字键，如1，4，1，3，4，2，4来控制每个连续的二元或三元组是如何加密的。1表示在第一个方块中使用Playfair将接下来的两个字母加密为二元模型。2表示在第二个方块中使用公平游戏将接下来的两个字母加密为二元字符。3表示在第三个方块中使用Playfair将接下来的两个字母加密为一个二元模型。4表示使用三个正方形将接下来的3个字母加密为三元组。如果数字键包含每个数字中的至少一个，这是最好的。由于三方块比公平游戏强得多，数字4在数字键中应该比1、2或3出现得更频繁。大约50%是合适的。也就是说，4的出现频率应该与1、2和3的总和一样多。等价地，生成1到6的随机数，用4、5或6的三个平方。

由于Playfair ThreeSquare 混合了二元模型和三元模型，大约一半的二元模型和三分之二的三元模型不会落在偶数边界上。这意味着力量的增加要大于公平竞赛广场T3的增加。公平竞赛三方形被评为七。

将Playfair、两个正方形 和三个正方形组合成一个更复杂的密码是可能的，毫无疑问会更强大，但Playfair的三个正方形已经超越了人类编码员所能做到的极限。速度和准确性都会受到影响。

有一种相反的方法，我称之为横跨三个正方形的*。将明文分组为包含四个块的行，每个块包含3个字符。使用三方密码加密每个区块。现在取第一组的最后一个字母和第二组的第一个字母，用第一个波利比乌斯方的Playfair密码对二元模型加密。取块2的最后一个字母和块3的第一个字母，用Playfair密码和第二个波利比乌斯方对二元模型加密。取第三组的最后一个字母和第四组的第一个字母，用第三个波利比乌斯方对二元模型加密。这提高了三平方密码的强度，而没有增加太多的复杂性或时间。通篇使用同一行规则 。*

## 9.5四方形

*四方形* 密码是由费利克斯-玛丽·德拉斯特勒大约在1890年发明的，并在他于1902年去世3个月后出版的著作*中有所描述。在四方密码之后，Delastelle发明了两方 密码，作为一个简化的稍不安全的版本。然而，使用第9.3节中描述的相同行规则，两个密码可以被认为强度相等。*

顾名思义，四方T3】密码利用了四个波利比乌斯方。其中两个方块包含标准字母表，另外两个方块包含使用独立键混合的字母表。消息一次加密两个字母，即四个正方形 加密二元模型。

这里是一个示例安排。

![9-unnumb-15](img/9-unnumb-15.png)

加密使用大家熟悉的 矩形方案。您在标准字母表中找到两个明文字母，并用矩形对角的字母替换它们，如下所示:

![9-unnumb-16](img/9-unnumb-16.png)

由于两个明文字母永远不会出现在10×10网格的同一行或同一列，因此不需要特殊的规则，也不需要分隔双字母。唯一需要空字符的地方是完成最后一个二元模型。四方形被评为五。

循环法

为了获得更多的力量，你可以使用一个简单的换位，类似于第4.6.1节中的分段反转。这种移调使用重复的数字键，如1，3，1，4，2，6。将密文分成7个字符或任何其他奇数长度的块。在每个方块上写下连续的关键数字。然后循环每个块，向左移动关键数字指示的位置数。例如，如果关键数字是4，您可以将最左边的4个数字移动到块的右端。这里有一个例子:

![9-unnumb-17](img/9-unnumb-17.png)

四格 采用循环法被评为六格。

减半法

加强四方 的另一种方法是事先调换信息。假设消息是威尔金斯大使今天暗杀了喀布尔。这有39个字母。39除以2，再向上取整得20。将信息写为两行，每行20个字母，并读出垂直读取的二元模型。用四个正方形加密这些二元模型。

![9-unnumb-18](img/9-unnumb-18.png)

这些二元模型不再具有英语二元模型的正常二元模型频率或正常接触频率。四个正方形 用减半的方法被评为 七个。

## 9.6双歧

让我们 再来看一个基于5×5波利比乌斯正方形的历史手密码。这是*双歧*密码，也是由费利克斯-玛丽·德拉斯特勒在19世纪90年代发明的。Bifid是一种3步密码，其中(1)将字母转换成它们的波利比乌斯坐标，(2)重新排列这些坐标，以及(3)然后将坐标转换回字母。最初，Delastelle在每个字母下面垂直写下整个信息，然后他组合成对的水平坐标，首先穿过顶行，然后穿过底行。

现代的方法是将信息分成固定大小的块。块大小应该是奇数，例如5、7或9。如果块大小是偶数，那么Emily可以将块分成二元模型。

第一步是将字母转换成它们在波利比乌斯广场的坐标。假设块长度是5。这5个明文字母可以表示为X1、X2、X3、X4和X5。它们的行列坐标可以表示为R1C1、R2C2、R3C3、R4C4和R5C5。这些R和C符号中的每一个都是从1到5的数字，首先是行坐标，其次是列坐标。这些坐标对垂直写在方块中每个字母的下面，就像这样:

![9-unnumb-19](img/9-unnumb-19.png)

然后按照R1R2、R3R4、R5C1、C2C3、C4C5的顺序读取它们。这里有一个例子。单词MAJOR是用一个波利比乌斯方块加密的，这个方块是用关键字 SAMPLE混合而成的。

![9-unnumb-20](img/9-unnumb-20.png)

注意，密文中的第三组字母坐标， **R5C1** ，是行/列对。这意味着第三个密文字母将来自同一行， **R5** ，在波利比乌斯广场作为第五个明文字母，而来自同一列，**【C1】**，作为第一个明文字母。这种行坐标和列坐标的同时出现称为*自然* 。

由于正方形中每行有5个字母，每列有5个字母，因此第三个密文字母与第五个明文字母相同的概率为1/5，第三个密文字母与第一个明文字母相同的概率为1/5。即有20%的几率 **R5C1** 与 **R5C5** 相同，有20%的几率 **R5C1** 与 **R1C1** 相同。在这个例子中，这正是所发生的事情。第五个明文字母是R，第三个密文字母也是 **R** 。

现在看第一封密文信， **R1R2** 。这是行/行对，不是行/列对。这里只有第一个坐标 **R1** 处于行/列对的正确位置。另一个坐标， **R2** ，是列位置的行坐标。这样的单个放置被称为*半自然*T15】。这意味着第一个密文字母与第一个明文字母来自波利比乌斯广场的同一行。所以第一个密文字母和第一个明文字母有20%的几率相同。

第二、第四和第五个密文字母也会出现这种情况。它们中的每一个都与一个明文字母处于同一行或同一列。因此，它们中的每一个都有20%的机会与那个明文字母相同。在这个例子中，第二个密文字母 **J** 与第三个明文字母相同。

这是bifid密码中的一个严重弱点，这使得Emily很容易猜测和放置可能的单词。另一方面，如果明文和密文字母不同，那么你知道它们在同一行或同一列。示例中，第一个明文字母 **R1C1** 为M，第一个密文字母 **R1R2** 为 **S** 。这意味着M和S必须在波利比乌斯广场的同一行。当艾米丽推断或猜测一个单词时，它提供了几个这样的等价。这反过来使得放置附加单词变得更加容易。当积累了足够多的字母对时，艾米丽可以重建正方形。

由于这些弱点，双歧密码被评为三级。

### 9.6.1共轭基质双歧

这些 的问题可以通过使用不同的波利比乌斯方块将坐标转换回字母来解决。例如，平方2产生密文 **VBJEF** 。

![9-unnumb-21](img/9-unnumb-21.png)

具有两个独立波利比乌斯正方形的双歧管被戏称为*共轭矩阵双歧管* 。在这种情况下，矩阵仅仅意味着字母或字符的矩形阵列。共轭矩阵双歧密码被评为五级。

有几种方法可以增强bifid密码的强度。一种方法是使用重复的数字键如5、11、7来改变块长度。块长度将是这个密钥的循环重复，即5，11，7，5，11，7，5，...如果您愿意，可以通过使用链式数字生成器并将数字转换为奇数块长度来生成块长度。一种可能性是

![9-unnumb-22](img/9-unnumb-22.png)

所以，如果发生器产生了数字3、6、2、7、...，那么块长度将是11，7，9，9，...

使用一个短的重复密钥和共轭矩阵，该密码被评定为6级。使用长的重复密钥或使用随机数生成器生成块长度，密码的等级为7。

类似的想法是从每个块中的不同点开始读出坐标。您可以使用数字键来指定起始点的顺序。如果块长度是L，密钥中的每个数字可以是从1到2L的任何数字。从1到L的数字表示顶行坐标的起始位置，而从L+1到2L的数字表示底行坐标的起始位置，如下所示:

![9-unnumb-23](img/9-unnumb-23.png)

从左到右成对读取坐标。以下是使用数字键4，9读出坐标的顺序。起始位置4和9带有阴影。

![9-unnumb-24](img/9-unnumb-24.png)

这种方法将等级提高到6级。

加强双歧密码的另一种方法是使用更强的转置来混合坐标。使用长度为L的块的标准bifid获取2L坐标，并将其写入2×L块。坐标垂直写入块中，水平读出。我们认为这是一个非常简单的路线变换，如7.1节所述。在第七章中有几个更强的转位，特别是柱状转位。这种类型的密码的一个例子是由情报官员Fritz Nebel中尉发明并在第一次世界大战中被德国人使用的 *ADFGVX* 密码。在ADFGVX密码中，由字母A、D、F、G、V、X表示的坐标使用列转置混合，然后作为这些字母的字符串传输。这个密码被定为五级。

如果你使用更长的块，比如说20个字符，那么你将得到40个坐标。(使用这种方法，blo ck长度可以是偶数也可以是奇数。)这足以用柱状换位有效地混合坐标。或者，你可以回到Delastelle最初的概念，将整个信息的坐标作为一个单独的块。无论哪种方式，使用共轭矩阵这个密码是八级。使用双柱换位 的密码是十级。假设四个长的独立密钥和混合良好的字母，这是一个不可破解的纸笔密码。称之为*双柱状双歧*。

## 9.7对角分叉

一个 双歧密码的变体是把波利比乌斯坐标垂直写在每个字母下面，和往常一样，但要对角读出，从左下到右上(或西南到东北)。这被称为*左对角线* 或*对角线* 。(在纹章上，它被称为*条不祥的* ，表示非婚生育。)对于最后一个字母，您换行到第一列(阴影数字1)。这样做的好处是，没有自然人或半自然人帮助艾米丽猜词。这里有一个例子。

![9-unnumb-25](img/9-unnumb-25.png)

对角分叉被评为四。对于共轭矩阵，它被评定为5。对于共轭矩阵和周期性变化的嵌段大小，它被评定为6。与传统的双歧不同，奇数和偶数块大小都可以使用对角线 双歧。

## 9.8个6×6的正方形

如果您的信息包含大量数字，使用6×6的波利比乌斯正方形而不是5×5的正方形可能更有利。一个6×6的正方形允许你拥有完整的26个字母加上从0到9的数字。没有必要从字母表中省略J或Q。如果你是手工加密，这需要特别注意区分字母O、I、Z、S和G与数字0、1、2、5和6。有些人采用特殊的约定，比如在所有数字下面划线。我发现这既麻烦又容易出错。我通常只是夸大了区分这些字符的特征，比如用超宽的衬线写字母I。

前5节中的所有方法，即公平竞赛、两个正方形 、三个正方形、四个正方形和两叉，都可以与6×6个正方形一起使用，以及它们的所有 变体。

## 9.9三裂

如果你喜欢正方形，那么立方体怎么样？19世纪90年代，费利克斯-玛丽·德拉斯泰勒发明了另一种分割方法，即*三裂*密码。不是字母表的每个字母都用5进制的两位数来表示(五进制数)，而是每个字母都用3进制的三位数来表示(三进制数)。这给出了3×3×3，或3 <sup class="fm-superscript">3</sup> ，不同的3位数组合。这对于字母表的所有26个字母加上一个额外的字符来说足够了。Delastelle对第27个字符使用了+加号。

额外的字符+可能被用作一种标点符号 ，或者它可能是一个信号，表示下面的明文字母应该被解释为一个数字。对应关系+A = 1，+B = 2，...，+J = 0。字母表的其余部分也可以用作特殊字符。例如，+K表示句号，+L表示逗号，依此类推。

正如2位数的组合可以显示为5×5个字母的正方形一样，3位数的组合可以显示为3×3×3个字母的立方体。每个三元组中的3个数字可以解释为该字母所在的立方体中的坐标。这些坐标通常称为层、行和列。

这里是27个三元组合，按顺序排列，字母等价通过使用关键字示例和交替列进行弱混合。例如，字母N由三元组102表示，因此它将位于3×3×3字母立方体的第1层、第0行和第2列。

![9-unnumb-26](img/9-unnumb-26.png)

三裂密码 的工作原理与二裂密码相似。明文是以某种固定大小的块来写的。大小可以是不是3的倍数的任何数字。这3个数字垂直写在信息的每个字母下面，然后以3个为一组水平读出。然后使用相同的等价形式将它们转换回字母。下面是一个明文发送帮助和块大小为4的示例。

![9-unnumb-27](img/9-unnumb-27.png)

用于二裂的相同分析和技术也可用于三裂，它们具有相同的评级。您可以使用两个独立的替换表将字母转换为数字，并将数字转换回字母。您可以改变块的大小。你可以从每个区块的不同地方开始读出数字。您可以使用强换位来混合三进制数字。

一个自然的问题是，是否存在类似于对角分裂 的三裂密码 的对角版本。对角分叉相对于原始分叉的优势在于对角版本不会产生削弱原始版本的半自然。在类似的对角线三等分 中，每个组的中间数字将是三分之一自然数，因此优势丧失。然而，如果你使用两种不同的混合字母，一种用来写数字，另一种用来读出数字，自然的问题就消失了。有两个字母的对角线三等分被评为 五等分。

## 9.10三个立方体

当 我正在键入前一段关于三裂密码的内容时，我意识到3×3×3的立方排列有助于3维模拟9.3节中描述的两个正方形 密码。在二维空间中很容易看到两个正方形的密码，但是在三维空间中很难看到一个立方体，所以我将只从坐标的角度来描述这个新的密码。我们姑且称这个密码*三立方*T11】。

两个方块使用两个替换表一次加密两个字母，因此三个方块使用三个替换表一次加密三个字母。这里有一组三个表格，使用了关键词哥伦比亚大学、斯坦福大学和霍普金斯大学。这三个替换表被指定为S、T和U。S代表替换，T代表表格，U代表字母表中的下一个字母。

替换表将字母表中的26个字母和字符+与27个三元组相对应。

![9-unnumb-28](img/9-unnumb-28.png)

像三裂体 一样，三立方从垂直写下每个字母的三位数开始。第一个字母的3个数字取自替换表 S，第二个字母的3个数字取自表T，第三个字母的3个数字取自u。此处显示了该模式，并通过三字苍蝇进行了说明。

![9-unnumb-29](img/9-unnumb-29.png)

然后数字从左到右读出，这些横排的三联体又转换回字母。使用表S来转换顶行，使用表T来转换中间行，使用表U来转换底行，这似乎是很自然的。然而，这将导致1/9的可能性，即顶行与左列相同，因此第一个明文字母将被它自己替换。也就是9中有1的几率S1S2S3和S1T1U1相同。中间和底部的行也是如此。姑且称这种情况为，其中一位数相同，一个*部分自然* 。

为此，替换表S用于第二行，表T用于第三行，表U用于顶行。这消除了自然。这是模式。

![9-unnumb-30](img/9-unnumb-30.png)

由于手工加密时很难保持直线，我建议在每个三位数字上写替换选择表。这类似于使用Belaso密码(第5.5节)时在每个明文字母上写密钥字母。这里有一个例子，三个立方体使用明文消息飞向罗马。

![9-unnumb-31](img/9-unnumb-31.png)

三立方 密码被评为七级。

有一种简单的方法可以增强三立方密码。不要像我们刚才那样使用三个严格轮换的替换表将三元组转换回字母，而是使用一个键来设置读出表的顺序。密钥将由字母S、T和U以某种混乱的顺序组成，例如SUTUTTUUSTS。此密钥的长度不应是3的倍数。我把这个变种叫做*三个立方体加上* 。下面是如何使用这个读出的密钥对“飞往罗马”进行加密。

![9-unnumb-32](img/9-unnumb-32.png)

使用三个立方体加上大约1/3的字母会有部分自然。也就是说，3个写入数字中的一个将与一个读出数字相同。但是，艾米丽不会知道哪些字母有这种缺陷，也就无法利用它。

三个立方体加上被评为九。

因此，你很可能会说，有没有可能在不使密码过于复杂的情况下将评分提高到10分？谢谢你的关心。首先，让我们将替换表的数量从3个增加到6个。让我们称它们为S，T，U，V，W和x，而不是用严格的旋转来写三元组，斯图，斯图，斯图，...我们将使用另一个字母键，由这6个字母以某种混乱的顺序组成。写入键可以是TWXUSTTVWV，读出键可以是VWTXXSUSVTU。理想情况下，这些密钥的长度应该互为质数，并且都不能被3整除。这里的长度是10和11。姑且称这个密码为*三立方超级*T5】。这是一个三立方超级利用明文飞到纽约 的例子。

![9-unnumb-33](img/9-unnumb-33.png)

三立方超被评为十。这是另一个 无法破解的手密码。

## 9.11矩形网格

上升 到现在我们只讨论了正方形和立方体的字母数组。密码术中没有要求字母网格的所有维度都相同的限制。英文字母表有26个字母，基本上是历史偶然，26非常接近5×5。如果我们使用33个字母的俄罗斯字母表，我们可能会选择4×8或5×7的矩形。

如果我们想拥有字母表中所有的26个字母，那么一个3×9或4×7的矩形可能更好。这些给你完整的26个字母加上一个或两个额外的字符。我们之前已经讨论过这种额外字符的使用，例如在字母和数字之间切换。假设所有的矩形都朝向同一个方向，大多数基于波利比乌斯正方形的密码对3×9或4×7的矩形和对5×5的矩形一样有效。这些是公平游戏，两个正方形 ，三个正方形，四个正方形 ，以及对角双歧 密码。

事实上，这5个密码在与那些矩形一起使用时可能会更强大，因为字母表中的每个字母都有更多可能的替代物。当使用Playfair或Two Square 时，不利的一面是两个字母在同一行的可能性更高，因此会被它们下面或右边的字母替换。

这是一个用3×9 矩形做的公平密码的例子:

![9-unnumb-34](img/9-unnumb-34.png)

## 9.12十六进制小数

所以 到目前为止这一章只关注手法。这意味着小数组只使用大写字母。对于计算机应用，你通常需要完整的字母，大写和小写，数字，标点符号，特殊符号，音调符号，也许还有多个字母。简而言之，你可能需要计算机的全文功能。最简单的方法是使用一种标准的计算机代码，如 UTF-8或UTF-16 ，用一个8位字节来表示每个字符。

分割8位字节的一种自然方法是将其分成两个4位十六进制数字，或十六进制数字。基于波利比乌斯正方形的所有分割方法也适用于16×16正方形，即Playfair、两个正方形、三个正方形、四个正方形和两叉 。如果16×16的正方形使用大的密钥很好地混合，则这些方法比用于5×5正方形的相同方法更强。这是因为256个字符的排列远远多于25个字符，即8.58×10 <sup class="fm-superscript">506</sup> 对 1.55×10 <sup class="fm-superscript">25</sup> 。

使用十六进制分段的一个简单方法是(1)通过使用混合良好的键控替换表将消息的字符转换成十六进制数字，(2)使用某种换位密码对这些数字进行加扰，然后(3)使用第二个混合良好的键控替换表将成对的十六进制数字转换回字节。

最简单的变换就是将第一个十六进制数字移动到最后，这样12 34 56 78就变成了23 45 67 81。这或许可以叫做*轮回妖术* 。它本质上是在底座16而不是底座5中完成的对角分叉(第9.7节)。十六进制循环等级为五。您也可以使用第4.6.1节中描述的分段反转换位 来打乱字母顺序。这可能叫做*分段十六进制* 。它也被评为五级。一种更强的方法是使用列转置密码对十六进制数字进行加扰。这可以称为*柱状六角形* 。它被评定为七级。使用双柱换位时，额定值增加到10。

这些方法可以用来加密任何计算机文件。然而，如果文件是纯文本，方法可以进一步增强。纯文本通常使用256个可能的字节值中不到100个。剩余的字符代码可用于空值、二元模型、三元模型以及第6.4节中描述的其他目的。如果做得好，这将提高评级为循环十六进制六，分段十六进制六，柱状十六进制T3八。

## 9.13逐位分馏

分割 也可以用代表信息中字符的单个位来完成。N个字符的块将由8N位表示。这些可以以几种方式形成一个矩形，例如2×4N、4×2N、8×N和N×8。例如，5个字母的块将由40位表示，这可以写成2行20位、4行10位、8行5位或5行8位。这对于手工操作来说很麻烦，但用计算机很容易做到。

这里有一个例子，说明如何将5个字符水平写入一个5×8的块中，然后垂直读出。这个例子使用了标准的 UTF-8字符编码。例如，大写字母A表示为01000001。明文是单词DELTA。

![9-unnumb-35](img/9-unnumb-35.png)

这些位按列依次读出。由于每列仅包含5位，密文的每个字节必须跨越两列或更多列。第一个密文字节的8位在第1列和第2列中找到，中间突出显示。第一列包含00000，第二列的前3位是111，因此密文的第一个字节是00000111，即十六进制07。这是控制字符铃，可追溯到电传时代，当时它用来引起回车铃响。它不再有图形表示了。我会用音符**来代表钟的性格。**

 **第二个密文字节来自跨越第2、3和4列的较暗的高亮部分。第2列的最后2位是11，第3列包含00000，第4列的第一位是0。综合这些，第二个密文字节是11000000。这代表了人物**à**，是大写的 **A** 带重音符。

密文的第3、4字节分别是**和 **x** ，即双引号和小写x，第5字节来自第7、8列，即000和01001。字节00001001代表**HTAB，或水平制表符，不可见。我用箭头**来表示。这样密文就是**à“x】**。******

 ****这看起来很神秘，但是这种方法很弱，因为它使用标准字母表来将明文转换成比特，以及将比特转换回字符。它被评为一级。如果这些步骤使用两个独立的混合键控字母，那么这个密码就是共轭矩阵双歧T3的二进制版本(9.6.1节)。这种方法可以叫做*六角矩形* 。它与共轭矩阵双歧密码具有相同的评级，即五。

将八个8位字节组成一个8×8位的正方形是很自然的。使用混合字母表将每个字符的8位垂直写入正方形，并使用不同的混合字母表水平读出它们。这只是一个8×8正方形版本的六边形矩形，等级为6。

### 9.13.1循环8×N

它 很容易提高这种密码的强度。对于任何N个字符的块，将其8位表示垂直写入8×N矩形。将每一行从0到N-1位位置循环左移一定量。例如， ab cdefgh循环移位，或者*旋转* ，左移2个位置将得到cdefgh ab 。然后垂直读出每个8位列。这是一个使用8×8位正方形的例子。每行向左循环其左侧指示的量。

![9-unnumb-36](img/9-unnumb-36.png)

这种密码是手工所能做到的极限。它需要3个键，即用于混合2个字母的2个键和用于指定偏移量的8位键。可以称之为*循环8×N*T3。当N等于或大于6时，它被评定为7。随着块大小N的增加，密码变得更强。

当矩形是正方形时，你可以旋转行和列，得到一个*双环8×8* 密码。你应该为此改变方向。水平写入位，垂直循环位，水平循环位，垂直读出字符。双环8×8 评级八。

循环8×N 密码可以重复得到一个*双循环8×N* 密码。这需要5个键，即混合3个字母的3个键，以及控制2轮移位的两个8位数的键。有5个步骤。(1)用第一个字母表做一个简单的替换。产生的N个字节垂直写入8×N位矩形。(2)使用第一移位键循环移位行。(3)用第二个字母表对N列进行简单的替换。(4)使用第二移位键循环移位行。(5)使用第三个字母对垂直列进行最后的简单替换。注意，所有的移位都是水平的，所有的替换都是垂直的。双循环8×N密码被评为九级。

如果需要，这可以延续到*三倍*、*四倍*甚至更高。所有这些变化都可以通过周期性地或使用随机 号 发生器改变块的大小来进一步增强。

## 9.14其他分馏

在第9.12和9.13节中，我们看到了将一个字节分成两个十六进制数字或八个单独的位。有许多其他划分8位的方法，例如3，2，3。如果每个字符的3，2，3位表示垂直书写，然后3行循环左移一定数量的位置，则每列仍将具有3，2，3位分布，因此8位可以转换回字节。这里有一个例子。每行向左循环左边所示的位置数，即分别为1个位置、3个位置和2个位置。

![9-unnumb-37](img/9-unnumb-37.png)

这里的明文隐退已经转化成了密文**@ w****θ****k _****【╝**。姑且称此为*位周期替换* 。这个方法被评为五级。像第9.13.1节中的循环8×N 密码一样，这可以是两倍、三倍或更多，并且块大小可以变化。

这一基本理念可以通过两种强有力的方式得到强化。

首先，字节可以有几种不同的划分方式，比如1，3，2，2或者2，4，2。例如，您可以首先使用3，2，3分割对块进行加密，然后使用1，3，2，2分割对其进行重新加密，然后使用2，4，2分割对其进行重新加密。这将涉及7个关键和7个步骤。(1)使用第一个替换产生消息的3，2，3比特表示。(2)使用第一个Shift键移动3行。(3)使用第二次替换产生字节的1，3，2，2位表示。(4)按第二个Shift键移动4行。(5)使用第三次替换来产生字节的2，4，2位表示。(6)按第三个Shift键移动3行。(7)使用第四次替换产生最终的密文字节。

第二，消息块可以用几种不同的方式划分。假设您使用32个字符的长明文块。对于前面技术中的步骤2，您可以将32个字节分成6、14和12个字节的组。对于步骤4，您可以将32个字节分成11、8和13个字节的组。对于步骤6，您可以将32个字节分成8、17和7个字节的组。每一组将被独立转移。对于每个消息，这种划分可能是不同的。

或者，你可以采取更包容的方法。对于步骤2，将整个消息划分为大小为X的块。对于步骤4，将消息划分为大小为Y的块。对于步骤6，将消息划分为大小为Z的块。X、Y和Z可以是从6字节到整个消息长度的任何长度。

我不会评价所有的位周期替代 的变化。可以说，评级范围可能在5到10之间。在第12章中，我将描述如何验证一个分组密码真正值得10级。

## 9.15更坚固的积木

本章中描述的几种加密算法都是针对明文块的。你可以对明文块做几件事，让你的密码对Emily来说更难一点。以下是一些想法:

*   周期性地或伪随机地改变块长度。

*   周期性地或随机地反转每个方块的前几个字母。

*   周期性地或伪随机地反转每个方块的最后几个字母。

*   周期性地或伪随机地向左或向右循环每个块。

*   将该块的最后N个字母与下一块的前N个字母交换。

但是有一个警告:如果你是手工加密和解密，请谨慎使用这些方法。如果你让你的密码如此复杂，以至于你不能准确地加密和解密，那么它就变得一文不值。**************